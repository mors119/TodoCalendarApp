import{r as i,I as g,_ as y,P as T,d as R,u as C,j as e,M as D,e as $,s as E,c as k,R as S,a3 as M,h as O}from"./index-C2pazGou.js";import{u as I,E as L}from"./EditTodo-XLH45uPm.js";import{T as h,R as U,a as z,f as p,s as B}from"./date-DcI7OpYU.js";var F={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M505.7 661a8 8 0 0012.6 0l112-141.7c4.1-5.2.4-12.9-6.3-12.9h-74.1V168c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v338.3H400c-6.7 0-10.4 7.7-6.3 12.9l112 141.8zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z"}}]},name:"download",theme:"outlined"},V=function(o,r){return i.createElement(g,y({},o,{ref:r,icon:F}))},_=i.forwardRef(V);const H=(c,o="todos.txt")=>{const r=c.map(a=>`제목: ${a.title}
 설명: ${a.description}
 기간: ${a.starts} ~ ${a.ends}
 우선순위: ${T(a.priority)}

`).join(`------------------------------
`),m=new Blob([r],{type:"text/plain"}),d=URL.createObjectURL(m),t=document.createElement("a");t.href=d,t.download=o,document.body.appendChild(t),t.click(),document.body.removeChild(t),URL.revokeObjectURL(d)},G=({dateState:c,addBtn:o})=>{const{editTodo:r,resetEditTodo:m,setEditTodo:d}=R(),{selectedDate:t}=I(),[a,x]=i.useState([]),[f,u]=i.useState(0),{member:j}=C();i.useEffect(()=>{(async()=>{try{const n=c||B(t),v=(await M(j,n)).sort((w,N)=>w.complete-N.complete);x(v)}catch(n){console.error(" Todo 로딩 오류:",n),x([])}})()},[t,c,f,o]);const b=async s=>{await O(s),x(n=>n.map(l=>l.id===s?{...l,complete:l.complete===1?0:1}:l))};return e.jsx("div",{className:"max-w-xl mx-auto mt-4 min-h-96",children:a.length>0?r?e.jsx("div",{className:k("top-0 left-0 bg-neutral-200/20 w-full h-full absolute duration-200 z-50 sm:p-4 justify-center flex items-center",r!=null?"translate-x-0 opacity-100":"translate-x-full opacity-0"),children:e.jsx("div",{className:"border border-neutral-500 bg-white h-fit rounded-xl sm:p-4 p-2 shadow md:w-[600px] w-full",children:e.jsxs("div",{className:"sm:px-4 sm:pb-4 rounded-md max-w-[600px]",children:[e.jsxs("div",{className:"flex justify-between mb-4",children:[e.jsx("div",{}),e.jsx("div",{className:"font-bold text-xl",children:"Todo 수정"}),e.jsx("button",{className:"cursor-pointer w-6 h-6 rounded-sm flex items-center justify-center hover:bg-amber-200/20",onClick:()=>{m(),u(s=>s+1)},children:e.jsx(S,{className:"hover:rotate-180 duration-300"})})]}),e.jsx(L,{})]})})}):a.map(s=>e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute top-3",children:e.jsxs(h,{onClick:()=>H(a,`todos_${t}.txt`),className:"mb-4 cursor-pointer",children:[e.jsx(_,{}),e.jsx("span",{className:"text-xs",children:"일정 다운로드"})]})}),e.jsxs("div",{className:"p-4 bg-amber-400/10 rounded-md mt-2 shadow-md",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"text-lg font-semibold cursor-pointer hover:underline",onClick:()=>{d(s)},children:s.title}),e.jsx(h,{color:s.complete===1?"green":"red",className:"cursor-pointer",onClick:()=>b(s.id),children:s.complete?e.jsxs(e.Fragment,{children:["완료됨  ",e.jsx(U,{})]}):e.jsxs(e.Fragment,{children:["진행 중  ",e.jsx(z,{})]})})]}),e.jsx("p",{className:"text-neutral-600",children:s.description}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("div",{className:"text-sm text-neutral-400",children:[p(s.starts)," ~ ",p(s.ends)]}),e.jsx(h,{className:"cursor-pointer",onClick:async()=>{D.confirm({title:"삭제하면 복구되지 않습니다.",content:"데이터를 삭제하시겠습니까?",onOk:async()=>{await $(s.id),E.success("데이터가 삭제되었습니다."),u(n=>n+1)}})},children:"삭제하기"})]})]},s.id)]})):e.jsx("div",{className:"text-center text-neutral-400 mt-4",children:"등록된 일정이 없습니다."})})};export{G as S};

import{r as i,I as D,_ as S,P as $,a as E,a3 as k,u as M,a4 as O,j as e,M as I,e as L,s as U,c as z,R as B,a5 as F,h as V}from"./index-B7xBPaYo.js";import{u as _,E as H}from"./EditTodo-DmJSUTuh.js";import{T as j,R as P,a as K,f as b,s as q}from"./date-nn838wsW.js";var A={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M505.7 661a8 8 0 0012.6 0l112-141.7c4.1-5.2.4-12.9-6.3-12.9h-74.1V168c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v338.3H400c-6.7 0-10.4 7.7-6.3 12.9l112 141.8zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z"}}]},name:"download",theme:"outlined"},G=function(o,r){return i.createElement(D,S({},o,{ref:r,icon:A}))},J=i.forwardRef(G);const Q=(c,o="todos.txt")=>{const r=c.map(n=>`제목: ${n.title}
 설명: ${n.description}
 기간: ${n.starts} ~ ${n.ends}
 우선순위: ${$(n.priority)}

`).join(`------------------------------
`),m=new Blob([r],{type:"text/plain"}),d=URL.createObjectURL(m),a=document.createElement("a");a.href=d,a.download=o,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(d)},Z=({dateState:c,addBtn:o})=>{const{editTodo:r,resetEditTodo:m,setEditTodo:d,setSearchKeyword:a,refreshState:n,setRefreshState:v}=E(),w=k(),{selectedDate:x}=_(),[h,u]=i.useState([]),[N,p]=i.useState(0),{member:g}=M(),f=O();i.useEffect(()=>{const s=async()=>{try{const t=c||q(x),T=(await F(g,t)).sort((R,C)=>R.complete-C.complete);u(T)}catch(t){console.error(" Todo 로딩 오류:",t),u([])}};v(n),s()},[x,c,N,o]);const y=async s=>{await V(s),u(t=>t.map(l=>l.id===s?{...l,complete:l.complete===1?0:1}:l)),p(t=>t+1)};return e.jsx("div",{className:"max-w-xl mx-auto mt-4 min-h-96",children:h.length>0?r?e.jsx("div",{className:z("top-0 left-0 bg-neutral-200/20 w-full h-full absolute duration-200 z-50 sm:p-4 justify-center flex items-center",r!=null?"translate-x-0 opacity-100":"translate-x-full opacity-0"),children:e.jsx("div",{className:"border border-neutral-500 bg-white h-fit rounded-xl sm:p-4 p-2 shadow md:w-[600px] w-full",children:e.jsxs("div",{className:"sm:px-4 sm:pb-4 rounded-md max-w-[600px]",children:[e.jsxs("div",{className:"flex justify-between mb-4",children:[e.jsx("div",{}),e.jsx("div",{className:"font-bold text-xl",children:"Todo 수정"}),e.jsx("button",{className:"cursor-pointer w-6 h-6 rounded-sm flex items-center justify-center hover:bg-amber-200/20",onClick:()=>{m(),p(s=>s+1)},children:e.jsx(B,{className:"hover:rotate-180 duration-300"})})]}),e.jsx(H,{})]})})}):h.map(s=>e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute top-3",children:e.jsxs(j,{onClick:()=>Q(h,`todos_${x}.txt`),className:"mb-4 cursor-pointer",children:[e.jsx(J,{}),e.jsx("span",{className:"text-xs",children:"일정 다운로드"})]})}),e.jsxs("div",{className:"p-4 bg-amber-400/10 rounded-md mt-2 shadow-md",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"text-lg font-semibold cursor-pointer hover:underline",onClick:()=>{f.pathname!=="/calendar"?d(s):(a(s.title),w("/result",{state:{from:f.pathname}}))},children:s.title}),e.jsx(j,{color:s.complete===1?"green":"red",className:"cursor-pointer",onClick:()=>y(s.id),children:s.complete?e.jsxs(e.Fragment,{children:["완료됨  ",e.jsx(P,{})]}):e.jsxs(e.Fragment,{children:["진행 중  ",e.jsx(K,{})]})})]}),e.jsx("p",{className:"text-neutral-600",children:s.description}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("div",{className:"text-sm text-neutral-400",children:[b(s.starts)," ~ ",b(s.ends)]}),f.pathname!=="/calendar"&&e.jsx(j,{className:"cursor-pointer",onClick:async()=>{I.confirm({title:"삭제하면 복구되지 않습니다.",content:"데이터를 삭제하시겠습니까?",onOk:async()=>{await L(s.id),U.success("데이터가 삭제되었습니다."),p(t=>t+1)}})},children:"삭제하기"})]})]},s.id)]})):e.jsx("div",{className:"text-center text-neutral-400 mt-4",children:"등록된 일정이 없습니다."})})};export{Z as S};

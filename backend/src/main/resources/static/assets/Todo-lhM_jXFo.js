import{j as e,c as a,a as T,r as m,u as k,P as E,M as S,e as L,s as R,f as I,h as P,i as g,R as A}from"./index-B7xBPaYo.js";import{u as N,R as M,a as O,L as w,C as D,b as G}from"./paginationStore-DNNX_rky.js";import{T as p,f as v,R as H,a as $}from"./date-nn838wsW.js";import{E as U}from"./EditTodo-DmJSUTuh.js";import{T as B}from"./TodoForm-Mdvibhmw.js";import"./index-BMRWjYn7.js";const z=(s,t)=>{let r=[];switch(!0){case t<=5:r=Array.from({length:t},(c,l)=>l+1);break;case s<=3:r=[1,2,3,"...",t];break;case s>=t-2:r=[1,"...",t-2,t-1,t];break;default:r=[1,"...",s-1,s,s+1,"...",t]}return r};function Q(){const{currentPage:s,setCurrentPage:t,totalPages:r}=N(),c=z(s,r),l=i=>{typeof i=="number"&&i>0&&i<=r&&t(i)};return e.jsxs("div",{className:"inline-flex",children:[e.jsx(C,{direction:"left",onClick:()=>l(s-1),isDisabled:s<=1}),e.jsx("div",{className:"flex -space-x-px",children:c.map((i,u)=>{let d;return u===0&&(d="first"),u===c.length-1&&(d="last"),c.length===1&&(d="single"),i==="..."&&(d="middle"),e.jsx(W,{page:i,position:d,isActive:s===i,onClick:()=>l(Number(i))},u)})}),e.jsx(C,{direction:"right",onClick:()=>l(s+1),isDisabled:s>=r})]})}function W({page:s,isActive:t,position:r,onClick:c}){const l=a("flex h-10 w-10 items-center justify-center text-sm  cursor-pointer",{"rounded-l-md":r==="first"||r==="single","rounded-r-md":r==="last"||r==="single","z-10 bg-amber-300/50":t,"hover:bg-amber-300/20 bg-neutral-300/20":!t&&r!=="middle","text-gray-300":r==="middle"});return e.jsx("div",{className:l,onClick:c,children:s})}function C({direction:s,isDisabled:t,onClick:r}){const c=a("flex h-10 w-10 items-center justify-center rounded-md cursor-pointer",{"pointer-events-none text-gray-300 bg-amber-200/20":t,"hover:opacity-50 bg-amber-300/50":!t,"mr-2 md:mr-4":s==="left","ml-2 md:ml-4":s==="right"}),l=s==="left"?e.jsx(M,{}):e.jsx(O,{});return e.jsx("div",{className:c,onClick:t?void 0:r,children:l})}function _({query:s,add:t}){const{currentPage:r,setTotalPages:c}=N(),{setEditTodo:l,editTodo:i}=T(),[u,d]=m.useState([]),[b,f]=m.useState(0),{member:x}=k();m.useEffect(()=>{(async()=>{try{const o=await I(x,r-1,s);d(o.content),c(o.totalPages)}catch{console.error("Todo 목록 로딩 오류")}})()},[r,b,s,!t]),m.useEffect(()=>{f(n=>n+1)},[i]);const y=async n=>{await P(n.id),d(o=>o.map(j=>j.id===n.id?{...j,complete:j.complete===1?0:1}:j)),f(o=>o+1)};return e.jsxs("div",{children:[e.jsx(w,{grid:{gutter:16,column:1},dataSource:u,renderItem:n=>e.jsx(w.Item,{children:e.jsxs(D,{title:n.title,className:"shadow-md",children:[e.jsx("p",{className:"text-gray-600",children:n.description}),e.jsxs("div",{className:"mt-2 flex justify-between items-center mb-2",children:[n.category?e.jsx(p,{color:"blue",children:n.category}):e.jsx("div",{}),e.jsx(p,{color:n.priority==="A"?"red":"orange",children:E(n.priority)})]}),e.jsxs("p",{className:"text-sm text-gray-500 mt-2",children:[v(n.starts)," ~ ",v(n.ends)]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(p,{className:"cursor-pointer",color:n.complete===1?"green":"red",onClick:()=>y(n),children:n.complete?e.jsxs("span",{children:["완료됨  ",e.jsx(H,{})]}):e.jsxs("span",{children:["진행 중  ",e.jsx($,{})]})}),e.jsxs("div",{className:"flex",children:[e.jsx(p,{color:"yellow",className:"cursor-pointer",onClick:()=>l(n),children:"수정하기"}),e.jsx(p,{className:"cursor-pointer",onClick:async()=>{S.confirm({title:"삭제하면 복구되지 않습니다.",content:"데이터를 삭제하시겠습니까?",onOk:async()=>{await L(n.id),R.success("데이터가 삭제되었습니다."),f(o=>o+1)}})},children:"삭제하기"})]})]})]})})}),e.jsx("div",{className:"flex justify-center mt-2 sm:mt-4",children:e.jsx(Q,{})})]})}function Y(){const[s,t]=m.useState(g.ALL),[r,c]=m.useState(g.ALL),{editTodo:l,resetEditTodo:i}=T(),[u,d]=m.useState(null),[b,f]=m.useState(!1),[x,y]=m.useState(""),{setCurrentPage:n}=N();m.useEffect(()=>{d(l),f(!1)},[l]);const o=j=>{const h=j.target.name;h==="closest"||h==="hardest"||h==="inProgress"||h==="all"?c(h):y(h),n(1),t(h)};return e.jsxs("div",{className:"max-w-3xl mx-auto sm:p-4 relative overflow-hidden min-h-[700px]",children:[e.jsxs("div",{children:[e.jsxs("div",{className:a("h-10 flex justify-between items-center text-center text-neutral-500 mb-2",r==="hardest"||r==="inProgress"?"":"mb-4"),children:[e.jsx("button",{name:"closest",onClick:o,className:a("w-1/4 border border-neutral-300 flex justify-center items-center h-full rounded-l-lg duration-200 cursor-pointer bg-amber-200/20",r===g.CLOSEST&&"bg-amber-300/30 border-none"),children:"Latest"}),e.jsx("button",{name:"hardest",onClick:o,className:a("w-1/4 border border-neutral-300 flex justify-center items-center h-full duration-200 cursor-pointer bg-amber-200/20",r===g.HARDEST&&"bg-amber-300/30 border-none"),children:"Level"}),e.jsx("button",{name:"inProgress",onClick:o,className:a("w-1/4 border border-neutral-300 flex justify-center items-center h-full duration-200 cursor-pointer bg-amber-200/20",r===g.IN_PROGRESS&&"bg-amber-300/30 border-none"),children:"Progress"}),e.jsx("button",{name:"all",onClick:o,className:a("w-1/4 border border-neutral-300 flex justify-center items-center h-full rounded-r-lg duration-200 cursor-pointer bg-amber-200/20",r===g.ALL&&"bg-amber-300/30 border-none"),children:"ALL"}),e.jsx("div",{className:"w-1/7 justify-end items-center flex",children:e.jsx("button",{onClick:()=>{f(!b),i()},className:"bg-amber-200/20 w-10 h-10 flex justify-center items-center rounded-full border border-neutral-300 hover:bg-amber-300/50 hover:border-neutral-600 cursor-pointer duration-200",children:e.jsx(G,{})})})]}),r==="hardest"&&e.jsxs("div",{className:a("w-full mb-4 h-0 flex justify-start duration-300",r==="hardest"&&"h-8"),children:[e.jsx("button",{name:"HIGH",onClick:o,className:a("w-1/4 border border-neutral-300 flex justify-center items-center h-full rounded-l-lg duration-200 cursor-pointer bg-amber-200/20",x==="HIGH"&&"bg-amber-300/30 border-none"),children:"high"}),e.jsx("button",{name:"MEDIUM",onClick:o,className:a("w-1/4 border border-neutral-300 flex justify-center items-center h-full duration-200 cursor-pointer bg-amber-200/20",x==="MEDIUM"&&"bg-amber-300/30 border-none"),children:"medium"}),e.jsx("button",{name:"LOW",onClick:o,className:a("w-1/4 border border-neutral-300 flex justify-center items-center h-full rounded-r-lg duration-200 cursor-pointer bg-amber-200/20",x==="LOW"&&"bg-amber-300/30 border-none"),children:"low"})]}),r==="inProgress"&&e.jsxs("div",{className:a("w-full mb-4 h-0 flex justify-start duration-300",r==="inProgress"&&"h-8"),children:[e.jsx("button",{name:"RUNNING",onClick:o,className:a("w-1/4 border border-neutral-300 flex justify-center items-center h-full rounded-l-lg duration-200 cursor-pointer bg-amber-200/20",x==="RUNNING"&&"bg-amber-300/30 border-none"),children:"running"}),e.jsx("button",{name:"COMPLETE",onClick:o,className:a("w-1/4 border border-neutral-300 flex justify-center rounded-r-lg items-center h-full duration-200 cursor-pointer bg-amber-200/20",x==="COMPLETE"&&"bg-amber-300/30 border-none"),children:"completed"})]}),e.jsx(_,{query:s,add:b})]}),e.jsx("div",{className:a("top-0 left-0 bg-neutral-200/20 w-full h-full absolute duration-200 z-50 sm:p-4 justify-center flex items-center",u!=null||b?"translate-x-0 opacity-100":"translate-x-full opacity-0"),children:e.jsx("div",{className:"border border-neutral-500 bg-white h-fit rounded-xl sm:p-4 p-2 shadow md:w-[600px] w-full",children:e.jsxs("div",{className:"sm:px-4 sm:pb-4 rounded-md max-w-[600px]",children:[e.jsxs("div",{className:"flex justify-between mb-4",children:[e.jsx("div",{}),e.jsx("div",{className:"font-bold text-xl",children:u!=null&&b===!1?"Todo 수정":"Todo 추가"}),e.jsx("button",{className:"cursor-pointer w-6 h-6 rounded-sm flex items-center justify-center hover:bg-amber-200/20",onClick:()=>{f(!1),d(null)},children:e.jsx(A,{className:"hover:rotate-180 duration-300"})})]}),u!=null&&b==!1?e.jsx(U,{}):e.jsx(B,{setAddBtn:()=>f(()=>!b)})]})})})]})}export{Y as default};
